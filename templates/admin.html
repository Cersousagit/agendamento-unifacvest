<!DOCTYPE html>
<html>
<head>
    <title>Admin</title>
    <style>
        body { margin:0; font-family:Arial; background:#f2f2f2; }
        header { background:#b30000; padding:15px; text-align:center; }
        img { height:50px; }
        .box { width:700px; margin:50px auto; background:white; padding:20px; border-radius:6px; }
        .card { display:inline-block; width:45%; padding:10px; background:#eee; text-align:center; }
        button { padding:5px 10px; border:none; color:white; }
        .conf { background:#b30000; }
        .pres { background:green; }
        .filter-form, .download-form { margin:20px 0; }
    </style>
</head>
<body>
<header>
    <img src="/static/unifacvest.png">
</header>
<div class="box">
    <h2>Provas Agendadas</h2>
    <div class="card">Pendentes<br><b>{{ pendentes|length }}</b></div>
    <div class="card">Confirmadas<br><b>{{ confirmadas|length }}</b></div>

    <h3>Aplicar Filtro por Período</h3>
    <form class="filter-form" method="get" action="/admin">
        <input type="date" name="filter_start" placeholder="Data início">
        <input type="date" name="filter_end" placeholder="Data fim">
        <button type="submit">Aplicar Filtro</button>
    </form>

    <h3>Baixar Planilha por Período</h3>
    <form class="download-form" method="get" action="/download">
        <input type="date" name="start" placeholder="Data início" required>
        <input type="date" name="end" placeholder="Data fim" required>
        <button type="submit">Baixar Excel</button>
    </form>

    <h3>Pendentes</h3>
    {% for p in pendentes %}
        <p>
            {{ p.nome }} – {{ p.disciplinas|join(', ') }}<br>
            {{ p.data }} às {{ p.hora }}<br>
            <a href="/confirmar/{{ p.id }}">
                <button class="conf">Confirmar</button>
            </a>
        </p>
        <hr>
    {% else %}
        <p>Nenhuma prova pendente.</p>
    {% endfor %}

    <h3>Confirmadas</h3>
    {% for c in confirmadas %}
        <p>
            {{ c.nome }} – {{ c.disciplinas|join(', ') }}<br>
            {{ c.data }} às {{ c.hora }}<br>
            <a href="/presenca/{{ c.id }}">
                <button class="pres">✔ Presença confirmada</button>
            </a>
        </p>
        <hr>
    {% else %}
        <p>Nenhuma prova confirmada.</p>
    {% endfor %}

    <a href="/sair">Sair</a>
</div>
</body>
</html>
